<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout/base :: layout(pageTitle='Mi Perfil', content=~{::#main-content}, pageScripts=~{::#page-scripts})}">
<body>

<main class="container-fluid p-4 animate__animated animate__fadeIn" id="main-content">
    <div class="card shadow-lg border-0 rounded-3">
        <div class="card-header bg-primary text-white border-bottom-0 p-4 rounded-top-3"><h3 class="fw-bold mb-0">Mi Perfil</h3></div>
        <div class="card-body p-4">
            <div id="alert-placeholder"></div>
            <form id="profile-form">
                <div class="row g-3">
                    <div class="col-md-6"><label class="form-label">Nombre</label><input type="text" id="profile-name" name="name" class="form-control" required></div>
                    <div class="col-md-6"><label class="form-label">Apellido</label><input type="text" id="profile-lastName" name="lastName" class="form-control" required></div>
                    <div class="col-12"><label class="form-label">Correo Electrónico</label><input type="email" id="profile-email" class="form-control" disabled></div>
                    <div class="col-12"><label class="form-label">Fecha de Nacimiento</label><input type="date" id="profile-birthDate" name="birthDate" class="form-control" required></div>
                    <div class="col-12 mt-4"><button type="submit" class="btn btn-primary rounded-pill px-4">Guardar Cambios</button></div>
                </div>
            </form>
        </div>
    </div>
</main>

<div id="page-scripts">
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            renderSidebar('profile');
            const user = AppState.currentUser;

            if (!user) {
                window.location.href = '/login';
                return;
            }

            // Llenamos el formulario con los datos del usuario desde AppState
            document.getElementById('profile-name').value = user.name || '';
            document.getElementById('profile-lastName').value = user.lastName || '';
            document.getElementById('profile-email').value = user.email || '';
            document.getElementById('profile-birthDate').value = user.birthDate || '';

            document.getElementById('profile-form').addEventListener('submit', (e) => {
                e.preventDefault();
                alert('¡Datos guardados (simulación)!');
                // Aquí iría la lógica para enviar los datos actualizados a la API
            });
        });
    </script>
</div>

</body>
</html>